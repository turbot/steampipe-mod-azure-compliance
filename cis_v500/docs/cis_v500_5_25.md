## Description

Users who are set as subscription owners are able to make administrative changes to the subscriptions and move them into and out of Microsoft Entra ID.

## Rationale

Azure subscriptions can be transferred between Microsoft Entra ID (formerly Azure AD) tenants. This capability is controlled by subscription policies that determine who can move subscriptions. By default, subscription owners may have the ability to transfer subscriptions between tenants, which creates significant security and governance risks:

**Security risks:**
- Subscription owners could move subscriptions to unauthorized tenants
- Resources could be moved outside organizational control
- Security policies and controls could be bypassed
- Compliance and regulatory boundaries could be violated
- Data could be exfiltrated by moving to attacker-controlled tenant

**Governance concerns:**
- Loss of visibility and management control over resources
- Subscription could be moved to tenant with weaker security
- Billing and cost management disrupted
- License and compliance tracking lost
- Audit trails could be obscured

**Data protection issues:**
- Data residency requirements could be violated
- Regulatory compliance could be compromised (GDPR, HIPAA, etc.)
- Data classification and protection policies lost
- Encryption keys and security controls disrupted

**Business continuity:**
- Critical resources could become inaccessible
- Production services could be disrupted
- Organizational knowledge of resources lost
- Recovery and remediation difficult

**Attack scenarios:**
- Compromised subscription owner account moves subscription to attacker tenant
- Malicious insider moves subscription before leaving organization
- Social engineering attack convinces owner to transfer subscription
- Ransomware-style attack holding subscription hostage in different tenant

By setting subscription policies to permit no one to move subscriptions:
- Prevents unauthorized subscription transfers
- Maintains organizational control over resources
- Ensures compliance with governance policies
- Protects against insider threats and external attacks
- Maintains data residency and compliance

This is a CIS Level 2 recommendation for organizations with stringent governance requirements.

## Audit

**From Azure Portal:**

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Properties`
3. Select `Manage subscription policies` (or similar option for subscription transfer settings)
4. Check the settings for:
   - `Subscription leaving Microsoft Entra tenant`: Should be set to `Permit no one`
   - `Subscription entering Microsoft Entra tenant`: Should be set to `Permit no one`

**From PowerShell:**

```powershell
Connect-AzureAD

# Get subscription policy settings
$policy = Get-AzureADMSAuthorizationPolicy
Write-Host "Allowed to add external tenants: $($policy.AllowedToAddExternalTenants)"
Write-Host "Allowed to sign up email based subscriptions: $($policy.AllowedToSignUpEmailBasedSubscriptions)"
```

**Note:** The specific property names may vary. The goal is to verify that subscription transfers in and out of the tenant are blocked.

**From Microsoft Graph API:**

```bash
az rest --method GET --uri "https://graph.microsoft.com/v1.0/policies/authorizationPolicy" --query "allowedToAddExternalTenants"
```

## Remediation

**From Azure Portal:**

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Properties`
3. Select `Manage subscription policies`
4. Set the following policies:
   - `Subscription leaving Microsoft Entra tenant`: Set to `Permit no one`
   - `Subscription entering Microsoft Entra tenant`: Set to `Permit no one`
5. Click `Save`

**Important:** These settings require Global Administrator privileges and may not be available in all tenant configurations. Refer to Microsoft documentation for the latest configuration options.

**Best Practices:**

1. **Document exceptions:**
   - If subscription transfers must be permitted, document the reasons
   - Require executive approval for any transfers
   - Maintain audit trail of transfer requests and approvals
   - Set up monitoring for transfer attempts

2. **Subscription governance:**
   - Maintain accurate inventory of all subscriptions
   - Document subscription ownership and purpose
   - Regular review of subscription assignments
   - Monitor for new or unexpected subscriptions
   - Track subscription lifecycle

3. **Access control:**
   - Limit who has subscription Owner role
   - Use Privileged Identity Management for Owner access
   - Regular review of subscription Owners (see recommendation 5.27)
   - Remove Owner access when no longer needed
   - Monitor Owner role assignments

4. **Alternative transfer process:**
   If transfers are needed:
   - Establish formal transfer request and approval process
   - Require security and compliance review
   - Temporarily enable transfer for approved cases only
   - Disable immediately after transfer
   - Full audit of transferred resources

5. **Monitoring and alerting:**
   - Monitor Azure Activity Log for policy changes
   - Alert on attempts to modify subscription policies
   - Track subscription transfer attempts
   - Review audit logs regularly
   - Set up compliance monitoring

6. **Backup and recovery:**
   - Maintain backups of critical resources
   - Document resource configuration
   - Test recovery procedures
   - Ensure backups are in protected location
   - Consider cross-region/cross-tenant backup strategy

7. **Communication:**
   - Inform subscription owners about the restriction
   - Provide process for legitimate transfer needs
   - Escalation procedures for urgent situations
   - Clear documentation of policies
   - Regular reminders about governance policies

8. **Consider management groups:**
   - Use management groups to organize subscriptions
   - Apply policies at management group level
   - Centralized governance across subscriptions
   - Inheritance of policies and controls
   - Better visibility and control

## Default Value

By default, subscription transfer policies may allow owners to transfer subscriptions. Organizations with strict governance requirements should disable this capability.

## References

- [Transfer an Azure subscription to a different Azure AD directory](https://docs.microsoft.com/en-us/azure/role-based-access-control/transfer-subscription)
- [Associate or add an Azure subscription to your Azure Active Directory tenant](https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/active-directory-how-subscriptions-associated-directory)
- [Organize your resources with Azure management groups](https://docs.microsoft.com/en-us/azure/governance/management-groups/overview)
- [Azure subscription and service limits, quotas, and constraints](https://docs.microsoft.com/en-us/azure/azure-resource-manager/management/azure-subscription-service-limits)

