## Description

Microsoft Defender for SQL servers on machines provides protections for SQL servers running on virtual machines and on-premises machines connected to Azure Arc.

Defender for SQL servers on machines provides:
- Vulnerability assessment
- Threat detection for SQL injection
- Brute force attack detection
- Anomalous database activities
- Detection of application exploits targeting SQL

This plan extends advanced threat protection to SQL servers running on IaaS VMs and hybrid environments.

## Remediation

### From Azure Portal

1. Go to `Microsoft Defender for Cloud`.
2. Under `Management`, select `Environment settings`.
3. Click on a subscription name.
4. Click `Defender plans` in the left pane.
5. Under `Cloud Workload Protection (CWP)`, locate `Databases` in the Plan column.
6. Set Status to `On`.
7. Ensure `SQL servers on machines` is enabled in the database plan settings.
8. Select `Save`.

### From Azure CLI

```bash
az security pricing create -n SqlServerVirtualMachines --tier 'standard'
```

### From PowerShell

```bash
Set-AzSecurityPricing -Name 'SqlServerVirtualMachines' -PricingTier 'Standard'
```

### Default Value

By default, Defender for SQL servers on machines is disabled.

