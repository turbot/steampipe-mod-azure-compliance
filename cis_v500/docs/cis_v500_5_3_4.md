## Description

Periodic review of privileged role assignments is performed to ensure that the privileged roles assigned to users are accurate and appropriate.

## Rationale

Privileged roles grant users elevated permissions to manage and configure Azure resources and Microsoft Entra ID. These roles include:
- Global Administrator
- Privileged Role Administrator
- Security Administrator
- User Administrator
- Billing Administrator
- Application Administrator
- And other administrative roles

Regular reviews of privileged role assignments are critical for:
- Ensuring only authorized users have elevated privileges
- Identifying and removing role assignments that are no longer needed
- Detecting potential security breaches or unauthorized privilege escalation
- Maintaining compliance with regulatory requirements
- Implementing the principle of least privilege
- Reducing the attack surface by limiting privileged accounts

Organizations should conduct formal reviews of all privileged role assignments at least quarterly. Reviews should include:
- Verification that each assignment is still necessary
- Confirmation that the assigned user still requires the role for their job function
- Assessment of whether a less privileged role would be sufficient
- Documentation of the review and any actions taken

## Audit

**Manual Audit Process:**

1. Document all current privileged role assignments
2. Interview role owners and assignment sponsors
3. Verify business justification for each assignment
4. Check if users have changed roles or left the organization
5. Document findings and remediation actions

**From Azure Portal:**

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Roles and administrators`
3. Review each administrative role:
   - Click on each role to see assignments
   - Note the users assigned to each role
   - Check assignment start dates
4. For each user, verify:
   - Current job function requires the role
   - No conflicting role assignments (segregation of duties)
   - User is still active in the organization

**From PowerShell:**

```powershell
Connect-AzureAD
# Get all directory roles
$roles = Get-AzureADDirectoryRole

# Export privileged role assignments to CSV for review
$report = @()
foreach ($role in $roles) {
    $members = Get-AzureADDirectoryRoleMember -ObjectId $role.ObjectId
    foreach ($member in $members) {
        $report += [PSCustomObject]@{
            Role = $role.DisplayName
            UserPrincipalName = $member.UserPrincipalName
            DisplayName = $member.DisplayName
            ObjectType = $member.ObjectType
            AccountEnabled = $member.AccountEnabled
        }
    }
}
$report | Export-Csv -Path "PrivilegedRoleAssignments.csv" -NoTypeInformation
Write-Host "Report exported to PrivilegedRoleAssignments.csv"
```

**From Azure CLI:**

```bash
# Get all directory role assignments
az rest --method GET --uri "https://graph.microsoft.com/v1.0/directoryRoles" --query "value[].{RoleName:displayName, RoleId:id}" -o json
```

## Remediation

**Establish a Regular Review Process:**

1. **Create a review schedule:**
   - Set up quarterly reviews of all privileged role assignments
   - Assign specific individuals or teams responsible for conducting reviews
   - Create a standardized review template and process

2. **Implement Azure AD Access Reviews (Recommended - Requires Azure AD Premium P2):**

   **From Azure Portal:**
   - From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
   - Select `Identity Governance`
   - Select `Access reviews`
   - Click `+ New access review`
   - Configure:
     - Review name: "Privileged Role Assignment Review"
     - Start date: Current date
     - Frequency: Quarterly
     - Duration: 2 weeks
     - Resources: Azure AD roles
     - Scope: All users with selected roles
     - Select specific privileged roles to review
     - Reviewers: Manager, self-review with manager approval, or specific reviewers
     - Upon completion: Configure what happens if reviewers don't respond
   - Click `Start`

3. **Remove unnecessary role assignments:**

   **From Azure Portal:**
   - From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
   - Select `Roles and administrators`
   - Click on a role
   - Select the assignment to remove
   - Click `Remove assignment`

   **From PowerShell:**
   ```powershell
   Connect-AzureAD
   # Remove a directory role member
   $roleId = (Get-AzureADDirectoryRole | Where-Object {$_.DisplayName -eq "<RoleName>"}).ObjectId
   $userId = (Get-AzureADUser -Filter "userPrincipalName eq '<user@example.com>'").ObjectId
   Remove-AzureADDirectoryRoleMember -ObjectId $roleId -MemberId $userId
   ```

4. **Implement Just-in-Time access where possible:**
   - Use Privileged Identity Management (PIM) for time-limited, approved access
   - Convert permanent assignments to eligible assignments
   - Require approval and justification for role activation

## Default Value

By default, there is no automatic review process for privileged role assignments. Organizations must establish their own review procedures.

## References

- [What are Azure AD access reviews?](https://docs.microsoft.com/en-us/azure/active-directory/governance/access-reviews-overview)
- [Best practices for Azure AD roles](https://docs.microsoft.com/en-us/azure/active-directory/roles/best-practices)
- [Azure AD built-in roles](https://docs.microsoft.com/en-us/azure/active-directory/roles/permissions-reference)

