## Description

Ensures that two alternate forms of identification are provided before allowing a password reset.

## Rationale

Self-service password reset (SSPR) allows users to reset their passwords without IT intervention. The number of authentication methods required for reset determines how secure the process is.

Requiring two methods of authentication before allowing a password reset significantly enhances security:
- Reduces the risk of unauthorized password resets by attackers
- Provides defense in depth - compromising one authentication method is insufficient
- Protects against social engineering attacks
- Helps prevent account takeover through password reset abuse
- Balances security with user convenience

Common authentication methods include:
- Mobile phone (SMS or call)
- Email address
- Security questions
- Microsoft Authenticator app
- Office phone
- Mobile app notification or code

Requiring two methods means an attacker would need to compromise multiple channels to successfully reset a password, making attacks significantly more difficult.

## Audit

**From Azure Portal:**

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Password reset` under `Manage`
3. Select `Authentication methods`
4. Check the setting for `Number of methods required to reset`
5. Verify that it is set to `2`

**Note:** This setting is a premium feature that requires Azure AD Premium P1 or P2 licensing.

## Remediation

**From Azure Portal:**

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Password reset` under `Manage`
3. Ensure that `Self service password reset enabled` is set to `All` or `Selected` (if targeting specific groups)
4. Select `Authentication methods`
5. Under `Number of methods required to reset`, select `2`
6. Under `Methods available to users`, ensure at least two methods are enabled, such as:
   - Email
   - Mobile phone
   - Office phone
   - Microsoft Authenticator app
   - Security questions (note: this is less secure than other options)
7. Click `Save`

**Important Recommendations:**

- Enable multiple authentication methods so users have options
- Avoid relying solely on security questions (least secure option)
- Prioritize methods like Microsoft Authenticator app and mobile phone
- Educate users on registering multiple authentication methods
- Monitor SSPR usage and failed attempts

**Prerequisites:**

- Azure AD Premium P1 or P2 licensing is required for SSPR
- Users must register their authentication methods before they can use SSPR
- Consider using combined registration for SSPR and MFA

## Default Value

By default, self-service password reset is disabled. If enabled, the default setting may vary but requiring 2 methods is the recommended configuration.

## References

- [How it works: Azure AD self-service password reset](https://docs.microsoft.com/en-us/azure/active-directory/authentication/concept-sspr-howitworks)
- [Plan an Azure Active Directory self-service password reset deployment](https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-sspr-deployment)
- [Authentication methods for Azure AD self-service password reset](https://docs.microsoft.com/en-us/azure/active-directory/authentication/concept-sspr-howitworks#authentication-methods)

