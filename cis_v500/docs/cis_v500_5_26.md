## Description

This recommendation aims to maintain a balance between security and operational efficiency by ensuring that a minimum of 2 and a maximum of 4 users are assigned the Global Administrator role in Microsoft Entra ID. Having at least two Global Administrators ensures redundancy, while limiting the number to four reduces the risk of excessive privileged access.

## Rationale

The Global Administrator role is the most powerful role in Microsoft Entra ID, with unrestricted access to all administrative features and the ability to:
- Manage all aspects of Entra ID and Microsoft 365 services
- Assign any role to any user (including Global Administrator)
- Reset passwords for any user
- Manage all subscriptions and resources
- Access and manage all organizational data
- Modify security settings and policies

**Why at least 2 Global Administrators:**
- **Redundancy**: Prevents lockout if one admin leaves or account is unavailable
- **Business continuity**: Ensures administrative access during emergencies
- **Separation of duties**: Allows different administrators for different scenarios
- **Coverage**: Provides backup when primary admin is unavailable
- **Account recovery**: One admin can help recover another's account

**Why no more than 4 (fewer than 5) Global Administrators:**
- **Reduced attack surface**: Each Global Admin is a high-value target for attackers
- **Principle of least privilege**: Most admin tasks don't require Global Admin
- **Accountability**: Fewer admins make it easier to track who did what
- **Insider threat mitigation**: Limits number of people with unrestricted access
- **Compliance**: Many frameworks require limiting privileged accounts
- **Password security**: Fewer accounts to secure and monitor
- **Compromise impact**: Limits potential damage from compromised account

**Security best practices:**
- Use emergency access (break-glass) accounts for true emergencies
- Implement Privileged Identity Management (PIM) for just-in-time access
- Most administrative tasks can be done with less privileged roles
- Assign specific administrative roles instead of Global Administrator
- Monitor Global Administrator activities closely

**Recommended approach:**
- 2-4 named user Global Administrators for day-to-day needs
- 1-2 break-glass accounts (cloud-only, excluded from MFA/Conditional Access)
- Use PIM for eligible Global Administrator access when needed
- Assign specific admin roles (User Admin, Security Admin, etc.) for routine tasks

## Audit

**From Azure Portal:**

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Roles and administrators`
3. Search for or find `Global Administrator`
4. Click on the role to view assignments
5. Count the number of active Global Administrator assignments
6. Verify the count is between 2 and 4 (fewer than 5)

**From PowerShell:**

```powershell
Connect-AzureAD

# Get Global Administrator role
$globalAdminRole = Get-AzureADDirectoryRole | Where-Object {$_.DisplayName -eq "Global Administrator"}

# Get members of Global Administrator role
$globalAdmins = Get-AzureADDirectoryRoleMember -ObjectId $globalAdminRole.ObjectId

# Display count and members
Write-Host "Number of Global Administrators: $($globalAdmins.Count)" -ForegroundColor Yellow

if ($globalAdmins.Count -lt 2) {
    Write-Host "WARNING: Less than 2 Global Administrators - redundancy risk!" -ForegroundColor Red
} elseif ($globalAdmins.Count -ge 5) {
    Write-Host "WARNING: 5 or more Global Administrators - excessive privileged access!" -ForegroundColor Red
} else {
    Write-Host "Global Administrator count is within recommended range (2-4)" -ForegroundColor Green
}

# List all Global Administrators
foreach ($admin in $globalAdmins) {
    Write-Host "  - $($admin.UserPrincipalName) ($($admin.DisplayName))"
}
```

**From Azure CLI:**

```bash
# Get Global Administrator role members
az rest --method GET --uri "https://graph.microsoft.com/v1.0/directoryRoles" --query "value[?displayName=='Global Administrator'].id" -o tsv | xargs -I {} az rest --method GET --uri "https://graph.microsoft.com/v1.0/directoryRoles/{}/members" --query "value[].userPrincipalName" -o table
```

## Remediation

**Step 1: Review current Global Administrators**

```powershell
Connect-AzureAD

$globalAdminRole = Get-AzureADDirectoryRole | Where-Object {$_.DisplayName -eq "Global Administrator"}
$globalAdmins = Get-AzureADDirectoryRoleMember -ObjectId $globalAdminRole.ObjectId

Write-Host "Current Global Administrators:"
foreach ($admin in $globalAdmins) {
    Write-Host "  $($admin.UserPrincipalName) - Last sign-in: $(Get-AzureADUser -ObjectId $admin.ObjectId | Select-Object -ExpandProperty RefreshTokensValidFromDateTime)"
}
```

**Step 2: If you have fewer than 2, add more Global Administrators**

```powershell
# Add a user to Global Administrator role
$user = Get-AzureADUser -Filter "userPrincipalName eq '<user@example.com>'"
$globalAdminRole = Get-AzureADDirectoryRole | Where-Object {$_.DisplayName -eq "Global Administrator"}

Add-AzureADDirectoryRoleMember -ObjectId $globalAdminRole.ObjectId -RefObjectId $user.ObjectId
Write-Host "Added $($user.UserPrincipalName) to Global Administrator role"
```

**Step 3: If you have 5 or more, remove excessive Global Administrators**

Review each Global Admin and determine if they truly need the role:

```powershell
# Remove a user from Global Administrator role
$user = Get-AzureADUser -Filter "userPrincipalName eq '<user@example.com>'"
$globalAdminRole = Get-AzureADDirectoryRole | Where-Object {$_.DisplayName -eq "Global Administrator"}

Remove-AzureADDirectoryRoleMember -ObjectId $globalAdminRole.ObjectId -MemberId $user.ObjectId
Write-Host "Removed $($user.UserPrincipalName) from Global Administrator role"
```

**Step 4: Assign appropriate alternative roles**

Instead of Global Administrator, assign specific roles:

```powershell
# Assign a more appropriate role
$user = Get-AzureADUser -Filter "userPrincipalName eq '<user@example.com>'"

# Example: User Administrator role
$userAdminRole = Get-AzureADDirectoryRole | Where-Object {$_.DisplayName -eq "User Administrator"}
if (!$userAdminRole) {
    $roleTemplate = Get-AzureADDirectoryRoleTemplate | Where-Object {$_.DisplayName -eq "User Administrator"}
    Enable-AzureADDirectoryRole -RoleTemplateId $roleTemplate.ObjectId
    $userAdminRole = Get-AzureADDirectoryRole | Where-Object {$_.DisplayName -eq "User Administrator"}
}
Add-AzureADDirectoryRoleMember -ObjectId $userAdminRole.ObjectId -RefObjectId $user.ObjectId
```

**Common alternative roles:**
- **User Administrator**: Manage users and groups
- **Security Administrator**: Manage security features
- **Billing Administrator**: Manage billing and subscriptions
- **Helpdesk Administrator**: Reset passwords, manage support tickets
- **Exchange Administrator**: Manage Exchange Online
- **SharePoint Administrator**: Manage SharePoint Online
- **Teams Administrator**: Manage Microsoft Teams

**Step 5: Implement Privileged Identity Management (Recommended - Requires Azure AD Premium P2)**

Convert permanent assignments to eligible (just-in-time) assignments:

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Privileged Identity Management`
3. Select `Azure AD roles`
4. Select `Roles`
5. Find `Global Administrator`
6. Remove permanent assignments
7. Add eligible assignments
8. Configure activation requirements:
   - Maximum activation duration (e.g., 8 hours)
   - Require justification
   - Require MFA for activation
   - Require approval

**Best Practices:**

1. **Break-glass accounts:**
   - Create 1-2 emergency access accounts
   - Cloud-only accounts (not synced from on-premises)
   - Exclude from Conditional Access and MFA
   - Use complex, stored passwords (in secure location)
   - Monitor for use and alert immediately
   - Test periodically

2. **Regular review:**
   - Review Global Administrator assignments quarterly
   - Verify each person still needs the role
   - Check last sign-in dates
   - Remove inactive administrators
   - Document why each person has the role

3. **Security measures for Global Administrators:**
   - Require MFA (no exceptions except break-glass)
   - Use privileged access workstations (PAWs)
   - Separate admin accounts from regular user accounts
   - Enable sign-in risk policies
   - Monitor all activities
   - No email or web browsing from admin accounts

4. **Monitoring and alerting:**
   - Alert on any Global Administrator role changes
   - Monitor all Global Admin activities
   - Review audit logs regularly
   - Track usage of Global Admin privileges
   - Alert on suspicious activities

5. **Documentation:**
   - Document who has Global Administrator role and why
   - Document break-glass account procedures
   - Maintain contact information for all Global Admins
   - Document escalation procedures
   - Keep runbooks for emergency scenarios

## Default Value

By default, the user who creates the Azure AD/Entra ID tenant is assigned the Global Administrator role. Additional Global Administrators must be manually assigned.

## References

- [Azure AD built-in roles - Global Administrator](https://docs.microsoft.com/en-us/azure/active-directory/roles/permissions-reference#global-administrator)
- [Best practices for Azure AD roles](https://docs.microsoft.com/en-us/azure/active-directory/roles/best-practices)
- [Manage emergency access accounts in Azure AD](https://docs.microsoft.com/en-us/azure/active-directory/roles/security-emergency-access)
- [What is Privileged Identity Management?](https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-configure)
- [Securing privileged access for hybrid and cloud deployments in Azure AD](https://docs.microsoft.com/en-us/azure/active-directory/roles/security-planning)

