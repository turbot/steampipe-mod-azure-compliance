## Description

Microsoft Defender for Azure Cosmos DB scans all incoming network requests for threats to your Azure Cosmos DB resources.

Defender for Cosmos DB provides:
- Detection of SQL injection attempts
- Detection of potential data exfiltration
- Identification of anomalous database access patterns
- Suspicious authentication attempts
- Unusual query patterns

This plan helps protect Cosmos DB accounts against unauthorized access and data breaches.

## Remediation

### From Azure Portal

1. Go to `Microsoft Defender for Cloud`.
2. Under `Management`, select `Environment settings`.
3. Click on a subscription name.
4. Click `Defender plans` in the left pane.
5. Under `Cloud Workload Protection (CWP)`, locate `Databases` in the Plan column.
6. Set Status to `On`.
7. Ensure `Azure Cosmos DB` is enabled in the database plan settings.
8. Select `Save`.

### From Azure CLI

```bash
az security pricing create -n CosmosDbs --tier 'standard'
```

### From PowerShell

```bash
Set-AzSecurityPricing -Name 'CosmosDbs' -PricingTier 'Standard'
```

### Default Value

By default, Defender for Azure Cosmos DB is disabled.

