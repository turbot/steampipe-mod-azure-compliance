## Description

Microsoft Defender for Key Vault provides an additional layer of protection and security intelligence by detecting unusual and potentially harmful attempts to access or exploit Key Vault accounts.

Defender for Key Vault provides:
- Detection of anomalous access patterns
- Suspicious key vault operations
- Unusual service principal activities
- Access from suspicious IP addresses
- Potential data exfiltration attempts

This plan helps protect cryptographic keys, secrets, and certificates stored in Azure Key Vault.

## Remediation

### From Azure Portal

1. Go to `Microsoft Defender for Cloud`.
2. Under `Management`, select `Environment settings`.
3. Click on a subscription name.
4. Click `Defender plans` in the left pane.
5. Under `Cloud Workload Protection (CWP)`, locate `Key Vault` in the Plan column.
6. Set Status to `On`.
7. Select `Save`.

### From Azure CLI

```bash
az security pricing create -n KeyVaults --tier 'standard'
```

### From PowerShell

```bash
Set-AzSecurityPricing -Name 'KeyVaults' -PricingTier 'Standard'
```

### Default Value

By default, Defender for Key Vault is disabled.

