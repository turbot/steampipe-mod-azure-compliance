## Description

Microsoft Azure applies a default global banned password list to all user and admin accounts that are created and managed directly in Microsoft Entra ID. The Microsoft Entra password policy does not apply to user accounts that are synchronized from an on-premises Active Directory environment, unless Microsoft Entra ID Connect is used and EnforceCloudPasswordPolicyForPasswordSyncedUsers is enabled.

## Rationale

Password protection in Microsoft Entra ID helps defend against weak passwords. Azure AD includes a global banned password list that is automatically applied to all users. However, organizations can also create a custom banned password list to include terms specific to their organization, such as:
- Company name and variations
- Product names
- Office locations (headquarters, branches)
- Internal company-specific terms
- Abbreviations with specific company meaning
- Common passwords used within the organization

Enforcing a custom banned password list prevents users from choosing easily guessable passwords that include organization-specific information. This is important because:
- Attackers often target organization-specific terms in password attacks
- Users frequently include company names or products in their passwords
- Context-specific password lists are more effective than generic lists alone
- It reduces the success rate of targeted password-spraying attacks
- Combined with the global banned list, it provides defense in depth

The custom banned list can include up to 1000 terms and supports fuzzy matching to catch variations (e.g., substituting '0' for 'o', '!' for 'i').

## Audit

**From Azure Portal:**

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Security`
3. Select `Authentication methods`
4. Select `Password protection`
5. Under `Custom banned passwords`:
   - Verify that `Enforce custom list` is set to `Yes`
   - Check that the `Custom banned password list` contains organization-specific terms
   - Review the list to ensure it includes relevant terms

**Note:** Custom banned password lists require Azure AD Premium P1 or P2 licensing.

## Remediation

**From Azure Portal:**

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Security`
3. Select `Authentication methods`
4. Select `Password protection`
5. Under `Custom banned passwords`:
   - Set `Enforce custom list` to `Yes`
   - In `Custom banned password list`, add organization-specific terms (one per line), such as:
     - Company name and variations
     - Product names
     - Office locations
     - Department names
     - Common internal terms
   - You can add up to 1000 terms
6. Configure `Mode`:
   - Start with `Audit` mode to assess impact
   - After validation, change to `Enforced` mode
7. Click `Save`

**Example Custom Banned Password Terms:**

```
ContosoCompany
Contoso2024
ContosoHQ
ContosoProduct
ContosoPass
ContosoUser
HeadquartersNY
ProductAlpha
ProductBeta
```

**Best Practices:**

1. **Building your list:**
   - Include company name and common variations
   - Add product and service names
   - Include office location names
   - Add industry-specific terms
   - Include common phrases used in your organization
   - Review breach databases for commonly used passwords

2. **Testing before enforcement:**
   - Use Audit mode initially to see how many passwords would be blocked
   - Review the Azure AD audit logs for blocked password attempts
   - Adjust the list based on feedback
   - Communicate changes to users before enforcement

3. **Ongoing maintenance:**
   - Review and update the list quarterly
   - Add new product names or locations as they are created
   - Monitor for new trends in password attacks
   - Review Azure AD logs for patterns

4. **Additional password protection settings:**
   - Enable password protection for on-premises Active Directory
   - Configure Smart Lockout (recommendations 5.6 and 5.7)
   - Require MFA in addition to strong passwords
   - Implement password expiration policies if appropriate

**For hybrid environments (on-premises AD):**

To extend protection to on-premises Active Directory:
1. Install Azure AD Password Protection DC Agent on domain controllers
2. Install Azure AD Password Protection Proxy on at least two servers
3. Enable the feature in Azure AD
4. Configure enforcement mode

## Default Value

By default:
- The global banned password list is automatically enabled (Microsoft-managed)
- The custom banned password list is empty and not enforced
- Organizations must manually create and enable a custom list

## References

- [Eliminate bad passwords using Azure Active Directory Password Protection](https://docs.microsoft.com/en-us/azure/active-directory/authentication/concept-password-ban-bad)
- [Configure Azure Active Directory password protection](https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-password-ban-bad-on-premises-deploy)
- [Azure AD Password Protection FAQ](https://docs.microsoft.com/en-us/azure/active-directory/authentication/password-protection-faq)

