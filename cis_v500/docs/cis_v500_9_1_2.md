## Description

Ensure that SMB file shares are configured to use the latest supported SMB protocol version (SMB 3.1.1 or higher) for enhanced security features and better performance.

SMB 3.1.1 provides significant security improvements over earlier versions, including pre-authentication integrity using SHA-256 hashing, secure dialect negotiation, and improved encryption capabilities. Using older SMB versions exposes file shares to security vulnerabilities.

## Remediation

### From Azure Portal

1. Go to `Storage Accounts`.
2. For each storage account with file shares, under `Settings`, click `Configuration`.
3. Under `File share settings`, locate `SMB`.
4. Under `SMB version`, ensure that `SMB 3.1.1` is selected as the minimum version.
5. Click `Save`.

### From Azure CLI

```bash
az storage account update --name <storage-account> --resource-group <resource-group> --min-tls-version SMB3.1.1
```

### From PowerShell

```bash
Set-AzStorageAccount -ResourceGroupName <resource-group> -Name <storage-account> -MinimumTlsVersion SMB3_1_1
```

### Default Value

The default SMB version may vary. It is recommended to explicitly set SMB 3.1.1 as the minimum version.

