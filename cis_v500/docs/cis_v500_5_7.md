## Description

The account lockout duration value determines how long an account retains the status of lockout, and therefore how long before a user can continue to attempt to login after passing the lockout threshold.

## Rationale

Account lockout duration works together with the lockout threshold (recommendation 5.6) to protect against brute-force password attacks. When an account is locked after exceeding the threshold of failed login attempts, the lockout duration determines how long the attacker must wait before trying again.

A sufficient lockout duration:
- Significantly slows down automated brute-force attacks
- Makes password-guessing attacks impractical from a time perspective
- Provides time to detect and respond to attack attempts
- Forces attackers to use more resources (time) per attack
- Creates logs and audit trails of suspicious activity

Setting the duration too short (less than 60 seconds) provides minimal protection:
- Automated tools can simply wait and continue attacking
- Thousands of attempts can still be made per day
- The deterrent effect is negligible

Setting the duration too long may:
- Frustrate legitimate users who make mistakes
- Increase help desk burden
- Potentially enable denial-of-service attacks by deliberately locking out users

A minimum of 60 seconds provides a good baseline. Organizations with higher security requirements may consider longer durations (300-600 seconds or more).

## Audit

**From Azure Portal:**

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Security`
3. Select `Authentication methods`
4. Select `Password protection`
5. Under `Custom smart lockout`, check the `Lockout duration in seconds` setting
6. Verify that it is set to `60` or greater

**From PowerShell:**

```powershell
Connect-MsolService
Get-MsolPasswordPolicy -DomainName <your-domain.com>
```

**Note:** Smart Lockout settings require Azure AD Premium P1 or P2 licensing.

## Remediation

**From Azure Portal:**

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Security`
3. Select `Authentication methods`
4. Select `Password protection`
5. Under `Custom smart lockout`:
   - Set `Lockout duration in seconds` to `60` or greater (recommended: 60-300)
   - This works together with the `Lockout threshold` setting
6. Click `Save`

**Recommended Values:**

- **Standard security**: 60-120 seconds
- **Enhanced security**: 300-600 seconds (5-10 minutes)
- **High security**: 900-3600 seconds (15-60 minutes)

**From Microsoft Graph API:**

```bash
# Configure Smart Lockout duration
az rest --method PATCH \
  --uri "https://graph.microsoft.com/beta/settings" \
  --headers "Content-Type=application/json" \
  --body '{
    "values": [{
      "name": "LockoutDurationInSeconds",
      "value": "60"
    }]
  }'
```

**Best Practices:**

1. **Balance security and usability:**
   - Start with 60 seconds and increase based on security needs
   - Monitor lockout events and user complaints
   - Adjust duration based on your threat landscape

2. **Combine with other controls:**
   - Use together with lockout threshold (recommendation 5.6)
   - Implement Conditional Access policies
   - Enable Multi-Factor Authentication
   - Use Azure AD Password Protection

3. **Smart Lockout considerations:**
   - Azure AD Smart Lockout uses intelligence to distinguish between legitimate users and attackers
   - On-premises accounts synced to Azure AD can also benefit from cloud intelligence
   - Smart Lockout remembers the last three bad password hashes

4. **User education:**
   - Inform users about lockout policies
   - Provide clear instructions for password reset
   - Ensure self-service password reset is available
   - Train users on creating strong, memorable passwords

5. **Monitoring:**
   - Review sign-in logs for lockout events
   - Investigate patterns of lockouts that might indicate attacks
   - Alert on multiple lockouts across different accounts (potential attack campaign)

## Default Value

By default, Azure AD Smart Lockout is enabled with:
- Lockout duration: 60 seconds
- The lockout duration increases with subsequent lockout attempts

This default value meets the minimum recommendation.

## References

- [Protect user accounts from attacks with Azure Active Directory smart lockout](https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-password-smart-lockout)
- [Azure AD Password Protection](https://docs.microsoft.com/en-us/azure/active-directory/authentication/concept-password-ban-bad)
- [Password policies and account restrictions in Azure Active Directory](https://docs.microsoft.com/en-us/azure/active-directory/authentication/concept-sspr-policy)

