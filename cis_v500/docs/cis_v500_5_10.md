## Description

Ensure that users are notified on their primary and alternate emails on password resets.

## Rationale

Password reset notification is a critical security feature that alerts users when their password has been reset. This notification serves several important security purposes:

**Detection of unauthorized access:**
- Users are immediately alerted if someone else resets their password
- Provides early warning of potential account compromise
- Allows users to take immediate action if the reset was unauthorized

**Accountability and audit trail:**
- Creates awareness of all password changes
- Helps users track their own password management activities
- Provides evidence of security events

**Incident response:**
- Enables quick detection and response to account takeover attempts
- Users can immediately contact security team if they didn't initiate the reset
- Reduces the window of opportunity for attackers

**User awareness:**
- Reminds users of the importance of password security
- Reinforces security culture within the organization
- Educates users about potential threats

Without this notification, an attacker who successfully resets a user's password could access the account without the legitimate user's knowledge, potentially for an extended period.

## Audit

**From Azure Portal:**

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Password reset` under `Manage`
3. Select `Notifications`
4. Check the setting for `Notify users on password resets`
5. Verify that it is set to `Yes`

**Note:** Self-Service Password Reset (SSPR) requires Azure AD Premium P1 or P2 licensing.

## Remediation

**From Azure Portal:**

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Password reset` under `Manage`
3. Ensure that `Self service password reset enabled` is set to `All` or `Selected` (for target groups)
4. Select `Notifications`
5. Set `Notify users on password resets` to `Yes`
6. Also recommended: Set `Notify all admins when other admins reset their password` to `Yes` (see recommendation 5.11)
7. Click `Save`

**What happens when enabled:**

When a user's password is reset (through self-service or admin reset), the user will receive an email notification to:
- Their primary email address (if available)
- Their alternate email address (if configured)

The email will include:
- Confirmation that the password was reset
- Timestamp of the reset
- Information about what to do if they didn't initiate the reset
- Contact information for security/help desk

**Best Practices:**

1. **Email configuration:**
   - Ensure users have valid email addresses registered
   - Encourage users to register alternate email addresses
   - Regularly verify email addresses are current
   - Use email addresses outside the organization's domain if possible for alternate email

2. **User education:**
   - Train users to recognize legitimate password reset notifications
   - Teach users what to do if they receive unexpected notifications
   - Provide clear escalation procedures for suspected compromises
   - Warn users about phishing emails that mimic password reset notifications

3. **Incident response:**
   - Create procedures for responding to unauthorized password resets
   - Enable rapid account lockdown if unauthorized reset is detected
   - Investigate and document all unauthorized reset attempts
   - Review access logs for suspicious activity following resets

4. **Monitoring:**
   - Monitor password reset activities through Azure AD audit logs
   - Alert on multiple password resets for a single account
   - Track patterns that might indicate attacks
   - Review notification delivery success rates

5. **Additional security measures:**
   - Require MFA for password reset (when possible)
   - Implement Conditional Access policies for password reset
   - Use Azure AD Identity Protection to detect risky sign-ins
   - Enable admin notification for all password resets (recommendation 5.11)

## Default Value

By default, when SSPR is enabled, user notification on password reset may be disabled. Organizations should explicitly enable this setting.

## References

- [How it works: Azure AD self-service password reset](https://docs.microsoft.com/en-us/azure/active-directory/authentication/concept-sspr-howitworks)
- [Notifications in Azure AD self-service password reset](https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-sspr-notifications)
- [Plan an Azure Active Directory self-service password reset deployment](https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-sspr-deployment)

