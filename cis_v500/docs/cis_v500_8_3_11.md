## Description

Certificates stored in Azure Key Vault should have a validity period of 12 months or less to ensure regular rotation.

Long-lived certificates increase security risks:
- Greater window of opportunity if compromised
- Outdated cryptographic algorithms
- Difficulty in revocation management
- Non-compliance with security standards

Setting a maximum validity period of 12 months ensures:
- Regular certificate rotation
- Use of current cryptographic standards
- Better security hygiene
- Compliance with industry best practices (e.g., CA/Browser Forum Baseline Requirements)

## Remediation

### From Azure Portal

For existing certificates:

1. Go to `Key Vaults`.
2. For each Key Vault, click on `Certificates`.
3. Review the validity period of each certificate.
4. For certificates with validity > 12 months:
   - Request a new certificate with shorter validity
   - Update applications to use the new certificate
   - Delete or disable the old certificate

For new certificates:

1. When creating a certificate, under `Advanced Policy Configuration`:
2. Set `Validity Period (in months)` to `12` or less.
3. Enable `Auto-renewal` to ensure continuous coverage.

### From Azure CLI

Set certificate policy with 12-month validity:

```bash
az keyvault certificate set-attributes \
  --vault-name <vaultName> \
  --name <certificateName> \
  --policy "$(cat <<EOF
{
  "issuerParameters": {
    "name": "Self"
  },
  "x509CertificateProperties": {
    "validityInMonths": 12,
    "subject": "CN=<commonName>"
  }
}
EOF
)"
```

### From PowerShell

```bash
$policy = New-AzKeyVaultCertificatePolicy -SubjectName "CN=<commonName>" -IssuerName "Self" -ValidityInMonths 12
Set-AzKeyVaultCertificatePolicy -VaultName <vaultName> -Name <certificateName> -CertificatePolicy $policy
```

### Default Value

Certificate validity periods vary based on the issuing CA and certificate type. There is no default restriction on validity period.

