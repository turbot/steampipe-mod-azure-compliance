## Description

The Owner role in Azure grants full control over all resources in a subscription, including the ability to assign roles to others.

## Rationale

The Owner role at subscription level is one of the most powerful permissions in Azure RBAC. Users with the Owner role can:
- Create, modify, and delete any resource in the subscription
- Assign any role to any principal (including granting Owner to others)
- Modify access controls and security settings
- Access all data in the subscription
- Change subscription settings
- Potentially impact billing and costs significantly

**Why at least 2 subscription owners:**
- **Redundancy and business continuity**: Prevents lockout if one owner leaves or is unavailable
- **Emergency access**: Ensures someone can respond to critical issues
- **Account recovery**: One owner can help if another's account is compromised
- **Operational continuity**: Maintains ability to manage subscription during absences
- **Change management**: Allows for review and approval processes

**Why no more than 3 subscription owners:**
- **Reduced attack surface**: Each Owner is a high-value target
- **Principle of least privilege**: Most tasks don't require Owner access
- **Accountability**: Fewer owners make audit trails clearer
- **Access control**: Limits who can make critical changes
- **Insider threat mitigation**: Reduces risk of malicious actions
- **Blast radius**: Limits impact of compromised owner account
- **Security monitoring**: Easier to monitor activities of fewer accounts

**Comparison with Global Administrator (5.26):**
- Global Administrator is tenant-wide, Owner is subscription-scoped
- Both require similar restrictions for similar reasons
- Subscription owners have even more direct control over resources
- Smaller range (2-3 vs 2-4) reflects the more direct resource control

**Security considerations:**
- Use Contributor role instead of Owner when possible
- Implement just-in-time access through Privileged Identity Management
- Most administrative tasks don't require Owner permissions
- Many tasks can be done with specific built-in roles (e.g., Virtual Machine Contributor)

## Audit

**From Azure Portal:**

1. From Azure Home select `Subscriptions`
2. For each subscription:
   - Select the subscription
   - Click `Access control (IAM)`
   - Click `Role assignments`
   - Filter by Role: `Owner`
   - Count the number of user (not group or service principal) Owner assignments
   - Verify count is between 2 and 3

**From PowerShell:**

```powershell
Connect-AzAccount

# Get all subscriptions
$subscriptions = Get-AzSubscription

foreach ($sub in $subscriptions) {
    Set-AzContext -SubscriptionId $sub.Id

    # Get Owner role assignments at subscription level
    $owners = Get-AzRoleAssignment -RoleDefinitionName "Owner" | Where-Object {
        $_.Scope -eq "/subscriptions/$($sub.Id)" -and
        $_.ObjectType -eq "User"
    }

    Write-Host "`nSubscription: $($sub.Name)" -ForegroundColor Cyan
    Write-Host "Number of user Owners: $($owners.Count)" -ForegroundColor Yellow

    if ($owners.Count -lt 2) {
        Write-Host "  WARNING: Less than 2 Owners - redundancy risk!" -ForegroundColor Red
    } elseif ($owners.Count -gt 3) {
        Write-Host "  WARNING: More than 3 Owners - excessive privileged access!" -ForegroundColor Red
    } else {
        Write-Host "  Owner count is within recommended range (2-3)" -ForegroundColor Green
    }

    # List owners
    foreach ($owner in $owners) {
        Write-Host "  - $($owner.DisplayName) ($($owner.SignInName))"
    }
}
```

**From Azure CLI:**

```bash
# List subscriptions
for sub in $(az account list --query "[].id" -o tsv); do
    echo "Subscription: $sub"
    az role assignment list --subscription $sub --role "Owner" --query "[?principalType=='User'].{Name:principalName, Scope:scope}" -o table
    echo "---"
done
```

## Remediation

**Step 1: Review current subscription owners**

```powershell
Connect-AzAccount

$subscriptions = Get-AzSubscription
foreach ($sub in $subscriptions) {
    Set-AzContext -SubscriptionId $sub.Id

    $owners = Get-AzRoleAssignment -RoleDefinitionName "Owner" | Where-Object {
        $_.Scope -eq "/subscriptions/$($sub.Id)" -and
        $_.ObjectType -eq "User"
    }

    Write-Host "Subscription: $($sub.Name)"
    Write-Host "Current user Owners: $($owners.Count)"
    foreach ($owner in $owners) {
        Write-Host "  - $($owner.DisplayName) ($($owner.SignInName))"
    }
}
```

**Step 2: If fewer than 2 owners, add more**

```powershell
Connect-AzAccount
Set-AzContext -SubscriptionId "<subscription-id>"

# Add a user as Owner
New-AzRoleAssignment -SignInName "<user@example.com>" `
                     -RoleDefinitionName "Owner" `
                     -Scope "/subscriptions/<subscription-id>"
```

**From Azure Portal:**
1. From Azure Home select `Subscriptions`
2. Select the subscription
3. Click `Access control (IAM)`
4. Click `+ Add` > `Add role assignment`
5. Select Role: `Owner`
6. Select the user to add
7. Click `Save`

**Step 3: If more than 3 owners, remove excess**

First, determine if they truly need Owner access:

```powershell
Connect-AzAccount
Set-AzContext -SubscriptionId "<subscription-id>"

# Remove Owner role assignment
Remove-AzRoleAssignment -SignInName "<user@example.com>" `
                       -RoleDefinitionName "Owner" `
                       -Scope "/subscriptions/<subscription-id>"
```

**From Azure Portal:**
1. From Azure Home select `Subscriptions`
2. Select the subscription
3. Click `Access control (IAM)`
4. Click `Role assignments`
5. Find the Owner assignment to remove
6. Click `...` and select `Remove`

**Step 4: Assign appropriate alternative roles**

Instead of Owner, consider these roles:

```powershell
# Contributor - Can manage resources but not access control
New-AzRoleAssignment -SignInName "<user@example.com>" `
                     -RoleDefinitionName "Contributor" `
                     -Scope "/subscriptions/<subscription-id>"

# Reader - Read-only access
New-AzRoleAssignment -SignInName "<user@example.com>" `
                     -RoleDefinitionName "Reader" `
                     -Scope "/subscriptions/<subscription-id>"

# Specific resource roles
New-AzRoleAssignment -SignInName "<user@example.com>" `
                     -RoleDefinitionName "Virtual Machine Contributor" `
                     -ResourceGroupName "<resource-group-name>"
```

**Common alternative roles:**
- **Contributor**: Can create and manage all types of Azure resources but can't grant access
- **Reader**: Can view all resources but not make changes
- **User Access Administrator**: Can manage user access but not resources
- **Resource-specific roles**: Virtual Machine Contributor, Storage Account Contributor, etc.

**Step 5: Implement PIM for just-in-time Owner access (Recommended - Requires Azure AD Premium P2)**

1. From Azure Home select `Subscriptions`
2. Select the subscription
3. Click `Access control (IAM)`
4. Click `Privileged Identity Management`
5. Remove permanent Owner assignments
6. Add eligible Owner assignments
7. Configure activation requirements:
   - Maximum duration (e.g., 8 hours)
   - Require justification
   - Require approval
   - Require MFA

**Best Practices:**

1. **Regular reviews:**
   - Review Owner assignments quarterly
   - Verify each person still needs Owner access
   - Check if less privileged role would suffice
   - Remove inactive or unnecessary assignments
   - Document why each person has Owner role

2. **Principle of least privilege:**
   - Most tasks don't require Owner permissions
   - Use Contributor for resource management without RBAC changes
   - Use specific roles for targeted permissions
   - Implement PIM for temporary Owner elevation
   - Regular training on appropriate role usage

3. **Emergency access:**
   - Designate primary and backup owners
   - Ensure owners are in different departments/locations if possible
   - Document emergency procedures
   - Test owner capabilities periodically
   - Have escalation procedures

4. **Security measures:**
   - Require MFA for all subscription owners
   - Use Conditional Access policies for owners
   - Separate admin accounts from regular accounts
   - Monitor all Owner activities closely
   - Alert on role assignment changes
   - Use privileged access workstations (PAWs)

5. **Assignment scope:**
   - This recommendation is for subscription-level Owner
   - Resource group or resource-level Owner assignments are separate
   - Apply similar principles at all scopes
   - Use smallest scope necessary

6. **Monitoring and auditing:**
   - Monitor all Owner role assignments and removals
   - Track activities performed by Owners
   - Review Azure Activity Log regularly
   - Alert on high-impact actions by Owners
   - Regular compliance audits
   - Track who granted Owner permissions and why

7. **Documentation:**
   - Document who has Owner role and why
   - Maintain contact information for all Owners
   - Document approval process for Owner assignment
   - Keep audit trail of Owner role changes
   - Document escalation procedures

8. **Consider management groups:**
   - For organizations with many subscriptions
   - Apply consistent Owner policies across subscriptions
   - Centralized governance
   - Inheritance of policies

## Default Value

By default, the user who creates or is assigned to manage a subscription has the Owner role. Additional Owners must be manually assigned, and the total should be managed to stay within 2-3.

## References

- [Azure built-in roles - Owner](https://docs.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#owner)
- [Best practices for Azure RBAC](https://docs.microsoft.com/en-us/azure/role-based-access-control/best-practices)
- [Elevate access to manage all Azure subscriptions and management groups](https://docs.microsoft.com/en-us/azure/role-based-access-control/elevate-access-global-admin)
- [What is Azure AD Privileged Identity Management?](https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-configure)
- [Assign Azure roles using the Azure portal](https://docs.microsoft.com/en-us/azure/role-based-access-control/role-assignments-portal)

