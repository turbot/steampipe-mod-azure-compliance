## Description

Ensure that all Secrets in Role Based Access Control (RBAC) Azure Key Vaults have an expiration date set.

Azure Key Vault enables users to store and keep secrets within the Microsoft Azure environment. Secrets in Azure Key Vault are octet sequences with a maximum size of 25k bytes each. The `exp` (expiration date) attribute identifies the expiration time on or after which the secret MUST NOT be used. By default, secrets never expire. It is thus recommended to rotate secrets in the key vault and set an explicit expiration date for all secrets. This ensures that the secrets cannot be used beyond their assigned lifetimes.

## Remediation

### From Azure Portal

1. Go to `Key Vaults`.
2. For each Key Vault, click on `Secrets`.
3. In the main pane, ensure that an appropriate `Expiration date` is set for any secrets that are `Enabled`.

### From Azure CLI

Update the `Expiration date` for the secret using the below command:

```bash
az keyvault secret set-attributes --name <secretName> --vault-name <vaultName> --expires Y-m-d'T'H:M:S'Z'
```

**Note:**
To view the expiration date on all secrets in a Key Vault using Microsoft API, the "List" Secret permission is required.

To update the expiration date for the secrets:
1. Go to the Key vault, click on Access Control (IAM).
2. Click on Add role assignment and assign the role of Key Vault Secrets Officer to the appropriate user.

### From PowerShell

```bash
Set-AzKeyVaultSecretAttribute -VaultName <VaultName> -Name <SecretName> -Expires <DateTime>
```

### Default Value

By default, secrets do not expire.

