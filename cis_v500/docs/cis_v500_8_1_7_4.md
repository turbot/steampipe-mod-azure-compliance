## Description

Turning on Microsoft Defender for SQL servers on machines enables threat detection for SQL servers on machines, providing threat intelligence, anomaly detection, and behavior analytics in Microsoft Defender for Cloud.

Enabling Microsoft Defender for SQL servers on machines allows for greater defensein-depth, functionality for discovering and classifying sensitive data, surfacing and mitigating potential database vulnerabilities, and detecting anomalous activities that could indicate a threat to your database.

## Remediation

### Remediate from Azure Portal

1. Go to `Microsoft Defender for Cloud`.
2. Under `Management`, select `Environment settings`.
3. Click on a subscription name.
4. Click `Defender plans` in the left pane.
5. Click `Select types > `in the row for Databases.
6. Set the toggle switch next to `SQL servers on machines` to `On`.
7. Select `Continue`.
8. Select `Save`.

### Remediate from Azure CLI

Run the following command:

```bash
az security pricing create -n SqlServerVirtualMachines --tier 'standard'
```

### Remediate from PowerShell

Run the following command:

```bash
Set-AzSecurityPricing -Name 'SqlServerVirtualMachines' -PricingTier 'Standard'
```

### Default Value

By default, Microsoft Defender plan is off.

