## Description

Enable Microsoft Defender CSPM to continuously assess cloud resources for security misconfigurations, compliance risks, and exposure to threats.

Microsoft Defender CSPM provides detailed visibility into the security state of assets and workloads and offers hardening guidance to help improve security posture.

## Remediation

### Remediate from Azure Portal

1. Go to `Microsoft Defender for Cloud.`
2. Under `Management`, click `Environment settings.`
3. Click the name of a subscription.
4. Select the `Defender plans` blade.
5. Under `Cloud Security Posture Management (CSPM)`, in the row for `Defender CSPM`, set the toggle switch for `Status` to `On`.
6. Click `Save`.

### Remediate from Azure CLI

Run the following command to enable Defender CSPM:

```bash
az security pricing create --name CloudPosture --tier Standard --extensions name=ApiPosture isEnabled=true
```

### Remediate from PowerShell

Run the following command to enable Defender CSPM:

```bash
Set-AzSecurityPricing -Name CloudPosture -PricingTier Standard -Extension '[{"name":"ApiPosture","isEnabled":"True"}]'
```

### Default Value

Defender CSPM is disabled by default.
