## Description

Turning on Microsoft Defender for Open-source relational databases enables threat detection for open-source relational databases (MySQL, PostgreSQL, MariaDB), providing threat intelligence, anomaly detection, and behavior analytics in Microsoft Defender for Cloud.

Defender for Open-source relational databases provides:
- Detection of brute force attacks
- SQL injection attempt detection
- Anomalous database access patterns
- Suspicious authentication activities
- Data exfiltration detection

This plan helps protect Azure Database for MySQL, PostgreSQL, and MariaDB against common database attacks.

## Remediation

### From Azure Portal

1. Go to `Microsoft Defender for Cloud`.
2. Under `Management`, select `Environment settings`.
3. Click on a subscription name.
4. Click `Defender plans` in the left pane.
5. Under `Cloud Workload Protection (CWP)`, locate `Databases` in the Plan column.
6. Set Status to `On`.
7. Ensure `Open-source relational databases` is enabled in the database plan settings.
8. Select `Save`.

### From Azure CLI

```bash
az security pricing create -n OpenSourceRelationalDatabases --tier 'standard'
```

### From PowerShell

```bash
Set-AzSecurityPricing -Name 'OpenSourceRelationalDatabases' -PricingTier 'Standard'
```

### Default Value

By default, Defender for Open-source relational databases is disabled.

