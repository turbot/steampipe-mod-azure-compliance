## Description

Ensure that the number of days before users are asked to re-confirm their authentication information is not set to 0.

## Rationale

Azure AD can be configured to periodically prompt users to re-confirm their registered authentication information (such as phone numbers, email addresses, and authentication app registrations) used for:
- Multi-Factor Authentication (MFA)
- Self-Service Password Reset (SSPR)
- Combined security information registration

If this setting is set to 0, users are never prompted to re-confirm their authentication information. This creates security risks:
- Users may no longer have access to registered phone numbers or email addresses
- Authentication methods may become stale or outdated
- Former phone numbers could be reassigned to other people
- Users may not be aware their authentication info is incorrect until they need it in an emergency
- Attackers who have modified a user's authentication info would have indefinite access

Regular re-confirmation ensures that:
- Authentication information remains current and accessible
- Users maintain control over their registered authentication methods
- Stale or compromised authentication methods are detected
- Users are reminded of their registered methods
- The security of MFA and SSPR mechanisms is maintained

A re-confirmation period between 90-180 days balances security with user experience. More frequent prompts may cause user frustration, while less frequent prompts reduce security effectiveness.

## Audit

**From Azure Portal:**

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Users`
3. Select `User settings`
4. Select `Manage user feature settings`
5. Under `Users can use the combined security information registration experience`:
   - Select `Manage settings for security info registration`
6. Check the setting for `Number of days before users are asked to re-confirm their authentication information`
7. Verify that it is **not** set to `0`
8. Recommended value: 90-180 days

**Note:** This feature requires Azure AD Premium P1 or P2 licensing and uses the combined security information registration experience.

## Remediation

**From Azure Portal:**

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Users`
3. Select `User settings`
4. Select `Manage user feature settings`
5. Under `Users can use the combined security information registration experience`:
   - Ensure this is enabled for all users or selected groups
   - Select `Manage settings for security info registration`
6. Set `Number of days before users are asked to re-confirm their authentication information` to a value between `90-180` days (recommended: 90 or 180)
7. Click `Save`

**Recommended Values:**

- **Standard security**: 180 days (6 months)
- **Enhanced security**: 90 days (3 months)
- **High security environments**: 60 days (2 months)

**From Microsoft Graph API:**

```bash
# Configure authentication method re-registration reminder
# This requires appropriate Graph API permissions
az rest --method PATCH \
  --uri "https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy" \
  --headers "Content-Type=application/json" \
  --body '{
    "registrationEnforcement": {
      "authenticationMethodsRegistrationCampaign": {
        "snoozeDurationInDays": 90
      }
    }
  }'
```

**Best Practices:**

1. **User communication:**
   - Notify users in advance about re-confirmation requirements
   - Provide clear instructions on how to update authentication info
   - Explain why re-confirmation is important for their security
   - Offer support resources for users who need help

2. **Implementation strategy:**
   - Start with a longer interval (e.g., 180 days) and reduce if needed
   - Monitor user feedback and help desk tickets
   - Consider different intervals for different user groups based on risk

3. **Combined with other controls:**
   - Ensure users have multiple authentication methods registered
   - Enable self-service password reset (SSPR)
   - Use Conditional Access to require MFA
   - Monitor sign-in logs for authentication failures

4. **Exception handling:**
   - Have a process for users who cannot access their authentication methods
   - Provide alternative verification methods for help desk
   - Document and monitor exception cases

5. **Monitoring:**
   - Track users who haven't confirmed authentication info
   - Review authentication method usage and updates
   - Identify users with potentially stale authentication methods
   - Generate reports on authentication method health

## Default Value

By default, the setting may be set to `0` (never), meaning users are never prompted to re-confirm their authentication information. This should be changed to a positive value (90-180 days recommended).

## References

- [Combined security information registration in Azure Active Directory](https://docs.microsoft.com/en-us/azure/active-directory/authentication/concept-registration-mfa-sspr-combined)
- [Manage user authentication methods](https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-mfa-userdevicesettings)
- [Azure AD authentication methods](https://docs.microsoft.com/en-us/azure/active-directory/authentication/concept-authentication-methods)

