## Description

This recommendation ensures that users accessing Microsoft Admin Portals (i.e. Microsoft 365 Admin, Microsoft 365 Defender, Exchange Admin Center, Azure Portal, etc.) are required to use multi-factor authentication (MFA) credentials when logging into an Admin Portal.

## Rationale

Microsoft Admin Portals provide access to administrative functions across various Microsoft services. These portals allow administrators to manage users, configure security settings, access sensitive data, and make organization-wide changes.

Requiring MFA for access to admin portals adds a critical layer of security:
- Protects against credential compromise for administrative accounts
- Reduces the risk of unauthorized administrative actions
- Helps meet compliance requirements for privileged access protection
- Provides an audit trail of authenticated administrative access

This control is essential as administrative portals are high-value targets for attackers.

## Audit

**From Azure Portal:**

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Security`
3. Select `Conditional Access`
4. Review policies to identify one that requires MFA for Microsoft Admin Portals
5. For such a policy, verify:
   - **Assignments > Users**: Should include `All users` or administrative roles/groups
   - **Assignments > Cloud apps or actions**:
     - Select `Select apps`
     - Search for and select `Microsoft Admin Portals`
   - **Access controls > Grant**:
     - `Grant access` should be selected
     - `Require multi-factor authentication` should be checked
   - **Enable policy**: Should be `On`

**From PowerShell:**

```powershell
Connect-AzureAD
$policies = Get-AzureADMSConditionalAccessPolicy
foreach ($policy in $policies) {
    # Microsoft Admin Portals is a built-in application that covers all admin portals
    if ($policy.Conditions.Applications.IncludeApplications -contains "MicrosoftAdminPortals" -and
        $policy.GrantControls.BuiltInControls -contains "mfa") {
        Write-Host "MFA policy for Microsoft Admin Portals found: $($policy.DisplayName)"
        Write-Host "Policy State: $($policy.State)"
    }
}
```

## Remediation

**From Azure Portal:**

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Security`
3. Select `Conditional Access`
4. Click `+ New policy`
5. Enter a name for the policy (e.g., "Require MFA for Admin Portals")
6. Under **Assignments**:
   - **Users**:
     - Include: `All users` or select specific administrative roles
     - Exclude: Emergency access accounts if needed
   - **Cloud apps or actions**:
     - Select `Select apps`
     - Click `Select`
     - Search for `Microsoft Admin Portals`
     - Select the application (this covers Azure Portal, Microsoft 365 admin center, Exchange admin center, etc.)
     - Click `Select`
7. Under **Access controls > Grant**:
   - Select `Grant access`
   - Check `Require multi-factor authentication`
8. Set **Enable policy** to `Report-only` initially to test
9. After validating, set **Enable policy** to `On`
10. Click `Create`

**Alternative - Using Directory Roles:**

For more granular control, you can target specific administrative roles:

1. Under **Assignments > Users**:
   - Select `Select users and groups`
   - Click on `Directory roles`
   - Select administrative roles such as:
     - Global Administrator
     - Privileged Role Administrator
     - Security Administrator
     - etc.

**Important Notes:**
- Test with Report-only mode first to assess impact
- Ensure administrators have registered for MFA before enforcement
- Always exclude emergency access accounts
- This policy complements but doesn't replace requiring MFA for all users

## Default Value

By default, no Conditional Access policy specifically requires MFA for Microsoft Admin Portals.

## References

- [Conditional Access: Require MFA for administrators](https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/howto-conditional-access-policy-admin-mfa)
- [Common Conditional Access policies](https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/concept-conditional-access-policy-common)
- [What is Conditional Access in Azure Active Directory?](https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/overview)

