## Description

Use private endpoints for your Azure Storage accounts to allow clients and services to securely access data located over a network via an encrypted Private Link.

A private endpoint uses an IP address from your virtual network's address space for your storage account. Network traffic between clients on the virtual network and the storage account traverses over the virtual network and a private link on the Microsoft backbone network, eliminating exposure from the public internet.

## Remediation

### From Azure Portal

1. Go to `Storage Accounts`.
2. For each storage account, under `Security + networking`, click `Networking`.
3. Click the `Private endpoint connections` tab.
4. Click `+ Private endpoint`.
5. Complete the wizard:
   - Select subscription and resource group
   - Provide a name for the private endpoint
   - Select the target sub-resource (blob, file, table, or queue)
   - Select the virtual network and subnet
   - Configure DNS integration as needed
6. Click `Review + create`, then `Create`.

### From Azure CLI

```bash
az network private-endpoint create \
  --name <endpoint-name> \
  --resource-group <resource-group> \
  --vnet-name <vnet-name> \
  --subnet <subnet-name> \
  --private-connection-resource-id $(az storage account show --name <storage-account> --resource-group <resource-group> --query id --output tsv) \
  --group-ids blob \
  --connection-name <connection-name>
```

### From PowerShell

```bash
$storageAccount = Get-AzStorageAccount -ResourceGroupName <resource-group> -Name <storage-account>
$subnet = Get-AzVirtualNetworkSubnetConfig -Name <subnet-name> -VirtualNetwork (Get-AzVirtualNetwork -Name <vnet-name> -ResourceGroupName <resource-group>)
$privateEndpoint = New-AzPrivateEndpoint -Name <endpoint-name> -ResourceGroupName <resource-group> -Location <location> -Subnet $subnet -PrivateLinkServiceConnection (New-AzPrivateLinkServiceConnection -Name <connection-name> -PrivateLinkServiceId $storageAccount.Id -GroupIds 'blob')
```

### Default Value

Private endpoints are not configured by default.

