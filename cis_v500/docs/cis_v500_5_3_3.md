## Description

The User Access Administrator role grants the ability to view all resources and manage access assignments at any subscription or management group level within the tenant. Due to its high privilege level, this role assignment should be removed immediately after completing the necessary changes at the root scope to minimize security risks.

## Rationale

The User Access Administrator role is one of the most powerful built-in roles in Azure. Users with this role can:
- Grant themselves or others any role on any resource
- Modify access for any resource in the subscription or management group
- View all resources regardless of their permissions

This role should be used only temporarily and for specific administrative tasks such as:
- Recovering access when normal administrators are locked out
- Performing large-scale role assignment reorganizations
- Implementing new RBAC structures across the organization

Permanent assignment of the User Access Administrator role violates the principle of least privilege and creates significant security risks:
- Increases the attack surface for privilege escalation
- Makes it difficult to audit who has access to what resources
- Creates a broad permission set that may be abused if the account is compromised

## Audit

**From Azure Portal:**

1. From Azure Home select `Subscriptions`
2. Select a subscription
3. Click `Access control (IAM)`
4. Click `Role assignments`
5. Filter by Role: `User Access Administrator`
6. Review the list of assignments:
   - Check if any permanent assignments exist
   - Verify if assignments are at the root/management group level
   - Confirm if assignments are justified and temporary

**From Azure CLI:**

```bash
# List User Access Administrator role assignments at subscription level
az role assignment list --role "User Access Administrator" --all --query "[].{Scope:scope, Principal:principalName, Type:principalType}" -o table

# Check at management group level
az account management-group show --name <management-group-id> --expand --recurse
```

**From PowerShell:**

```powershell
Connect-AzAccount
# Get all subscriptions
$subscriptions = Get-AzSubscription
foreach ($sub in $subscriptions) {
    Set-AzContext -SubscriptionId $sub.Id
    $roleAssignments = Get-AzRoleAssignment -RoleDefinitionName "User Access Administrator"
    foreach ($assignment in $roleAssignments) {
        Write-Host "Subscription: $($sub.Name)"
        Write-Host "Principal: $($assignment.DisplayName)"
        Write-Host "Scope: $($assignment.Scope)"
        Write-Host "------------------------"
    }
}
```

## Remediation

**From Azure Portal:**

1. From Azure Home select `Subscriptions`
2. Select a subscription
3. Click `Access control (IAM)`
4. Click `Role assignments`
5. Find the User Access Administrator role assignment that should be removed
6. Click the checkbox next to the assignment
7. Click `Remove`
8. Confirm the removal

**Alternative - Use PIM for Just-in-Time Access (Recommended):**

Instead of permanent assignments, use Azure AD Privileged Identity Management:

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Privileged Identity Management`
3. Select `Azure resources`
4. Select the subscription or management group
5. Select `Roles`
6. Find `User Access Administrator`
7. Click `+ Add assignments`
8. Select `Eligible` (not Active)
9. Select the user who needs temporary access
10. Set activation duration (e.g., 8 hours maximum)
11. Require justification and/or approval for activation

**From Azure CLI:**

```bash
# Remove a specific role assignment
az role assignment delete --assignee <user-principal-name> --role "User Access Administrator" --scope <scope>

# Example for subscription scope
az role assignment delete --assignee user@example.com --role "User Access Administrator" --scope /subscriptions/<subscription-id>
```

**From PowerShell:**

```powershell
Connect-AzAccount
Set-AzContext -SubscriptionId <subscription-id>
Remove-AzRoleAssignment -SignInName <user-principal-name> -RoleDefinitionName "User Access Administrator" -Scope <scope>
```

## Default Value

By default, no users are assigned the User Access Administrator role.

## References

- [Azure built-in roles](https://docs.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#user-access-administrator)
- [Elevate access to manage all Azure subscriptions and management groups](https://docs.microsoft.com/en-us/azure/role-based-access-control/elevate-access-global-admin)
- [What is Azure AD Privileged Identity Management?](https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-configure)

