## Description

Enable system updates recommendations in Microsoft Defender for Cloud to ensure virtual machines are kept up to date with the latest security patches.

Microsoft Defender for Cloud monitors VMs to identify missing system updates and security patches. When automatic provisioning is enabled for the Log Analytics agent, Defender for Cloud can collect update information and provide recommendations for:
- Missing security updates
- Critical OS patches
- Security configuration vulnerabilities

Keeping systems updated is critical for protecting against known vulnerabilities and exploits.

## Remediation

### From Azure Portal

1. Go to `Microsoft Defender for Cloud`.
2. Under `Management`, select `Environment settings`.
3. Click on a subscription name.
4. Click `Auto provisioning` in the left pane.
5. For `Log Analytics agent for Azure VMs`, set Status to `On`.
6. Select the workspace to use for data collection.
7. Click `Save`.

### From Azure CLI

```bash
az security auto-provisioning-setting update --auto-provision 'On' --name 'default'
```

### From PowerShell

```bash
Set-AzSecurityAutoProvisioningSetting -Name "default" -EnableAutoProvision
```

### Default Value

Auto-provisioning of the Log Analytics agent may be disabled by default.

