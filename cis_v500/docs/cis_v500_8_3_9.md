## Description

Automatic key rotation should be enabled for cryptographic keys stored in Azure Key Vault to reduce the risk of key compromise.

Key rotation is a security best practice that involves periodically changing cryptographic keys. Automatic key rotation in Azure Key Vault:
- Reduces the window of opportunity for key compromise
- Minimizes the impact if a key is compromised
- Ensures compliance with key rotation policies
- Automates the rotation process, reducing manual effort and errors

Keys should be rotated on a regular schedule (e.g., every 90 days) based on organizational security policies.

## Remediation

### From Azure Portal

1. Go to `Key Vaults`.
2. For each Key Vault, click on `Keys`.
3. Select a key to configure rotation.
4. Click `Rotation policy`.
5. Click `Enable automatic rotation`.
6. Set the rotation period (e.g., 90 days).
7. Configure notification settings (optional but recommended).
8. Click `Save`.

### From Azure CLI

```bash
az keyvault key rotation-policy update \
  --vault-name <vaultName> \
  --name <keyName> \
  --value '{
    "lifetimeActions": [{
      "trigger": {
        "timeAfterCreate": "P90D"
      },
      "action": {
        "type": "Rotate"
      }
    }],
    "attributes": {
      "expiryTime": "P2Y"
    }
  }'
```

### From PowerShell

```bash
$rotationPolicy = @{
    lifetimeActions = @(
        @{
            trigger = @{
                timeAfterCreate = "P90D"
            }
            action = @{
                type = "Rotate"
            }
        }
    )
    attributes = @{
        expiryTime = "P2Y"
    }
}

Set-AzKeyVaultKeyRotationPolicy -VaultName <vaultName> -Name <keyName> -PolicyPath $rotationPolicy
```

### Default Value

Automatic key rotation is not enabled by default.

