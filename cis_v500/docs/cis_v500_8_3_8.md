## Description

Use private endpoints for Azure Key Vault to allow clients and services to securely access data over a Private Link connection.

A private endpoint uses an IP address from your virtual network's address space for your Key Vault. Network traffic between clients on the virtual network and the Key Vault traverses over the virtual network and a private link on the Microsoft backbone network, eliminating exposure from the public internet.

Benefits of using private endpoints:
- Secure connectivity from on-premises networks
- Protection against data exfiltration
- Compliance with network isolation requirements
- Integration with private DNS zones

## Remediation

### From Azure Portal

1. Go to `Key Vaults`.
2. For each Key Vault, under `Settings`, click `Networking`.
3. Click the `Private endpoint connections` tab.
4. Click `+ Create`.
5. Complete the wizard:
   - Select subscription and resource group
   - Provide a name for the private endpoint
   - Select the virtual network and subnet
   - Integrate with private DNS zone (recommended)
6. Click `Review + create`, then `Create`.

### From Azure CLI

```bash
az network private-endpoint create \
  --name <endpoint-name> \
  --resource-group <resource-group> \
  --vnet-name <vnet-name> \
  --subnet <subnet-name> \
  --private-connection-resource-id $(az keyvault show --name <vault-name> --resource-group <resource-group> --query id --output tsv) \
  --group-id vault \
  --connection-name <connection-name>
```

### From PowerShell

```bash
$vault = Get-AzKeyVault -VaultName <vaultName> -ResourceGroupName <resourceGroupName>
$subnet = Get-AzVirtualNetworkSubnetConfig -Name <subnetName> -VirtualNetwork (Get-AzVirtualNetwork -Name <vnetName> -ResourceGroupName <resourceGroupName>)
$privateEndpoint = New-AzPrivateEndpoint -Name <endpointName> -ResourceGroupName <resourceGroupName> -Location <location> -Subnet $subnet -PrivateLinkServiceConnection (New-AzPrivateLinkServiceConnection -Name <connectionName> -PrivateLinkServiceId $vault.ResourceId -GroupIds 'vault')
```

### Default Value

Private endpoints are not configured by default.

