---
description: 
globs: 
alwaysApply: true
---
# Controls Structure in This Codebase

Controls are defined as HCL blocks using the `control` keyword. Each control must include:

- `title` - Clear descriptive title
- `description` - Detailed description of what this control checks
- `query` - Reference to the SQL query that implements the check
- `documentation` - Reference to detailed documentation file
- `tags` - Metadata including:
  - `service` - Service name (e.g. "Compute", "Storage", "IAM")
  - `type` - Must be "Control"
  - `category` - Category of control (e.g. "Security", "Compliance", "Operations")
  - `cis_item_id` - CIS benchmark item ID if applicable
  - `cis_level` - CIS level (1 or 2) if applicable
  - `cis_type` - CIS check type ("automated" or "manual") if applicable

Example:
```control "control_name" {
  title         = "Clear descriptive title"
  description   = "Detailed description"
  query         = query.control_query_name
  documentation = file("./docs/control_name.md")

  tags = merge(local.common_tags, {
    service     = "Service"
    type        = "Control"
    category    = "Security"
    cis_item_id = "1.1"
    cis_level   = "1"
    cis_type    = "automated"
  })
}```

2. Benchmarks Structure:
