## Description

Restrict security group creation to administrators only.

## Rationale

Security groups in Microsoft Entra ID and Azure are used to manage access to resources. They can be assigned permissions to:
- Azure resources (through RBAC)
- Microsoft Entra ID resources
- Applications
- Data in various Microsoft 365 services

By default, users may be able to create security groups, which creates several security and governance concerns:

**Security risks:**
- Users can create groups and grant themselves or others access
- Potential for unauthorized access escalation
- Groups created without security review or oversight
- Shadow IT scenarios with unmanaged access control
- Difficulty tracking and auditing all security groups

**Access control concerns:**
- Users might bypass formal access request processes
- No centralized approval for new groups
- Groups may be created with inappropriate permissions
- Lack of proper group naming and documentation standards
- Risk of conflicting or duplicate groups

**Governance challenges:**
- Proliferation of unmanaged security groups
- Difficulty maintaining accurate inventory of groups
- No ownership or lifecycle management for user-created groups
- Compliance and audit challenges
- Unable to enforce group creation policies

**Operational issues:**
- Inconsistent group naming conventions
- Lack of documentation about group purpose
- No defined group owners or points of contact
- Difficulty in group cleanup and maintenance
- Increased noise in directory

By restricting security group creation to administrators:
- Centralized control over access management
- Security review before groups are created
- Consistent group naming and documentation
- Clear ownership and lifecycle management
- Better compliance with security policies
- Reduced risk of unauthorized access

Administrators (or users with specific delegated permissions) should be the only ones creating security groups to ensure proper governance.

## Audit

**From Azure Portal:**

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Groups`
3. Select `General` settings
4. Under `Security Groups`, check the setting for `Users can create security groups in Azure portals, API or PowerShell`
5. Verify that it is set to `No`

**From PowerShell:**

```powershell
Connect-AzureAD
$settings = Get-AzureADDirectorySetting | Where-Object {$_.DisplayName -eq "Group.Unified"}

if ($settings) {
    $setting = $settings.Values | Where-Object {$_.Name -eq "EnableGroupCreation"}
    Write-Host "Users can create groups: $($setting.Value)"
} else {
    Write-Host "Group settings not configured - default behavior applies"
}
```

**Note:** This checks for the unified group creation setting. Security group creation settings should be verified through the portal.

## Remediation

**From Azure Portal:**

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Groups`
3. Select `General` settings
4. Under `Security Groups`, find `Users can create security groups in Azure portals, API or PowerShell`
5. Set this to `No`
6. Click `Save`

**Effect of this setting:**

When disabled:
- Only administrators can create security groups
- Regular users receive an error when attempting to create security groups
- Group creation through portal, PowerShell, CLI, and Graph API is restricted
- Users can still be members of security groups
- Users can still see and access resources through groups

**Who can still create security groups:**
- Global Administrator
- Groups Administrator
- User Administrator
- And other roles with group creation permissions

**Alternative approach - Delegate to specific users:**

If certain non-admin users need to create security groups, assign them appropriate roles:

```powershell
Connect-AzureAD
$role = Get-AzureADDirectoryRole | Where-Object {$_.DisplayName -eq "Groups Administrator"}

# Enable the role if not already enabled
if (!$role) {
    $roleTemplate = Get-AzureADDirectoryRoleTemplate | Where-Object {$_.DisplayName -eq "Groups Administrator"}
    Enable-AzureADDirectoryRole -RoleTemplateId $roleTemplate.ObjectId
    $role = Get-AzureADDirectoryRole | Where-Object {$_.DisplayName -eq "Groups Administrator"}
}

# Add user to the role
$user = Get-AzureADUser -Filter "userPrincipalName eq '<user@example.com>'"
Add-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -RefObjectId $user.ObjectId
```

**Best Practices:**

1. **Establish group request process:**
   - Create formal process for requesting new security groups
   - Define approval workflow
   - Require business justification
   - Document group purpose and ownership
   - Set up ticketing system for requests

2. **Group naming standards:**
   - Enforce consistent naming conventions
   - Include purpose, department, or resource type in name
   - Use prefixes or suffixes to categorize groups
   - Document naming standards clearly

3. **Group lifecycle management:**
   - Assign owners to all groups
   - Regular reviews of group membership (see recommendations 5.3.4, 5.3.7)
   - Process for decommissioning unused groups
   - Expiration policies for temporary groups
   - Track group creation and modification

4. **Documentation requirements:**
   - Document group purpose and intended use
   - List group owners and contacts
   - Track resources or permissions assigned to group
   - Maintain changelog of group modifications
   - Regular audit of group usage

5. **Delegation strategy:**
   - Identify users who legitimately need to create groups
   - Assign Groups Administrator role judiciously
   - Consider per-department group administrators
   - Review delegated permissions regularly
   - Document why each user has delegation

6. **Monitoring and auditing:**
   - Monitor security group creation events
   - Review group membership changes
   - Alert on unexpected group modifications
   - Regular compliance audits of groups
   - Track group permission assignments

7. **Consider alternatives:**
   - Use dynamic groups for automated membership
   - Implement access packages for resource access
   - Use Microsoft 365 Groups for collaboration (separate setting)
   - Leverage application-specific groups where appropriate

**Note on Microsoft 365 Groups:**
This setting only affects Azure AD security groups. For Microsoft 365 Groups (used in Teams, SharePoint, etc.), see recommendation 5.21.

## Default Value

The default setting varies, but may allow users to create security groups. Organizations should explicitly disable this capability unless there's a specific business need.

## References

- [Manage who can create Microsoft 365 Groups](https://docs.microsoft.com/en-us/microsoft-365/admin/create-groups/manage-creation-of-groups)
- [Azure AD groups and how they work](https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/active-directory-groups-create-azure-portal)
- [Default user permissions in Azure Active Directory](https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/users-default-permissions)
- [Azure AD built-in roles - Groups Administrator](https://docs.microsoft.com/en-us/azure/active-directory/roles/permissions-reference#groups-administrator)

