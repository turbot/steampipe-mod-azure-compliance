## Description

Multifactor authentication requires an individual to present a minimum of two separate forms of authentication before access is granted. Multifactor authentication provides additional assurance that the individual attempting to gain access is who they claim to be. With multifactor authentication, an attacker would need to compromise at least two different authentication mechanisms, increasing the difficulty of compromise and thus reducing the risk.

## Rationale

Multi-factor authentication is recommended for all user accounts. Enabling MFA is a simple and effective way to secure the identity platform and is a proven method to prevent identity-related breaches.

## Audit

**From Azure Portal:**

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Users`
3. Select `Per-user MFA` button from the top bar
4. Ensure that for each user `MULTI-FACTOR AUTH STATUS` is `Enabled` or `Enforced`

**From Azure CLI:**

The Entra ID commands require the Entra ID module which is not part of the standard Azure CLI distribution, and must be added to Azure CLI as an extension:

```bash
az extension add --name azure-active-directory
```

Then to enable MFA for a user:

```bash
az ad user list --query "[*].{Name:displayName, MFA:strongAuthenticationDetail.email}"
```

**From PowerShell:**

```powershell
Connect-MsolService
Get-MsolUser -All | Select-Object UserPrincipalName, @{N="MFA Status"; E={ if ($_.StrongAuthenticationRequirements.State -ne $null) {$_.StrongAuthenticationRequirements.State} else {"Disabled"}}}
```

## Remediation

**From Azure Portal:**

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Users`
3. Select `Per-user MFA` button from the top bar
4. Select the user(s) for whom you want to enable MFA
5. Under `quick steps` at the right, select `Enable`

**From PowerShell:**

```powershell
Connect-MsolService
$st = New-Object -TypeName Microsoft.Online.Administration.StrongAuthenticationRequirement
$st.RelyingParty = "*"
$st.State = "Enabled"
$sta = @($st)
Set-MsolUser -UserPrincipalName <user@example.com> -StrongAuthenticationRequirements $sta
```

**Note:** Enabling MFA for users is disruptive. Users will be required to set up their MFA method(s) the next time they sign in. It's recommended to communicate this change to users in advance.

## Default Value

By default, multi-factor authentication is disabled for all users.

## References

- [What is: Azure AD Multi-Factor Authentication](https://docs.microsoft.com/en-us/azure/active-directory/authentication/concept-mfa-howitworks)
- [Tutorial: Secure user sign-in events with Azure Multi-Factor Authentication](https://docs.microsoft.com/en-us/azure/active-directory/authentication/tutorial-enable-azure-mfa)

