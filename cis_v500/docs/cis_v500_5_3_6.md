## Description

Perform a periodic review of the Tenant Creator role assignment to ensure that the assignments are accurate and appropriate.

## Rationale

The Tenant Creator role allows users to create new Microsoft Entra ID tenants. This is a powerful capability that should be carefully controlled because:
- New tenants can be used to bypass organizational policies
- Tenants created outside of IT oversight may not follow security best practices
- Unmanaged tenants can lead to shadow IT and data exfiltration risks
- Creation of tenants may have licensing and cost implications
- Tenants created by unauthorized users may be used for malicious purposes

Only specific users who have a legitimate business need should have the Tenant Creator role, such as:
- IT administrators responsible for managing multi-tenant environments
- Enterprise architects planning new organizational structures
- Developers who need test tenants (with appropriate controls)

Regular reviews of the Tenant Creator role ensure:
- Only authorized users can create new tenants
- Users who no longer need this ability have it revoked
- Proper approval processes are followed for tenant creation
- Compliance with organizational policies on tenant management

## Audit

**From Azure Portal:**

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Users`
3. Select `User settings`
4. Under `Default user permissions`, review:
   - `Users can create tenants`: Check if this is set to `Yes` or `No`
   - If set to `Yes`, all users can create tenants
   - If set to `No`, only users with the Tenant Creator role can create tenants

5. To see who has the Tenant Creator role:
   - Select `Roles and administrators`
   - Search for or find `Tenant Creator`
   - Click on the role to view assignments
   - Review all users assigned this role

**From PowerShell:**

```powershell
Connect-AzureAD

# Check if all users can create tenants
$policy = Get-AzureADMSAuthorizationPolicy
Write-Host "Default user role - Can create tenants: $($policy.DefaultUserRolePermissions.AllowedToCreateTenants)"

# Get users with Tenant Creator role
$tenantCreatorRole = Get-AzureADDirectoryRole | Where-Object {$_.DisplayName -eq "Tenant Creator"}
if ($tenantCreatorRole) {
    $members = Get-AzureADDirectoryRoleMember -ObjectId $tenantCreatorRole.ObjectId
    Write-Host "`nUsers with Tenant Creator role:"
    foreach ($member in $members) {
        Write-Host "  - $($member.UserPrincipalName) ($($member.DisplayName))"
    }
} else {
    Write-Host "Tenant Creator role has no assignments"
}
```

**From Azure CLI:**

```bash
# Check tenant creation settings
az rest --method GET --uri "https://graph.microsoft.com/v1.0/policies/authorizationPolicy" --query "defaultUserRolePermissions.allowedToCreateTenants"

# Note: Listing Tenant Creator role assignments requires additional Graph API calls
```

## Remediation

**Restrict who can create tenants:**

1. **Disable tenant creation for all users (Recommended):**

   **From Azure Portal:**
   - From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
   - Select `Users`
   - Select `User settings`
   - Under `Default user permissions`:
     - Set `Users can create tenants` to `No`
   - Click `Save`

2. **Assign Tenant Creator role only to authorized users:**

   **From Azure Portal:**
   - From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
   - Select `Roles and administrators`
   - Find and click on `Tenant Creator`
   - Click `+ Add assignments`
   - Search for and select the user who needs this role
   - Optionally set an expiration date
   - Click `Add`

   **From PowerShell:**
   ```powershell
   Connect-AzureAD

   # Get the Tenant Creator role
   $role = Get-AzureADDirectoryRole | Where-Object {$_.DisplayName -eq "Tenant Creator"}

   # If role doesn't exist, enable it from the template
   if (!$role) {
       $roleTemplate = Get-AzureADDirectoryRoleTemplate | Where-Object {$_.DisplayName -eq "Tenant Creator"}
       Enable-AzureADDirectoryRole -RoleTemplateId $roleTemplate.ObjectId
       $role = Get-AzureADDirectoryRole | Where-Object {$_.DisplayName -eq "Tenant Creator"}
   }

   # Add a user to the role
   $user = Get-AzureADUser -Filter "userPrincipalName eq '<user@example.com>'"
   Add-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -RefObjectId $user.ObjectId
   ```

3. **Remove unauthorized users from Tenant Creator role:**

   **From Azure Portal:**
   - From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
   - Select `Roles and administrators`
   - Find and click on `Tenant Creator`
   - Select the user assignment to remove
   - Click `Remove assignment`

   **From PowerShell:**
   ```powershell
   Connect-AzureAD

   $role = Get-AzureADDirectoryRole | Where-Object {$_.DisplayName -eq "Tenant Creator"}
   $user = Get-AzureADUser -Filter "userPrincipalName eq '<user@example.com>'"
   Remove-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -MemberId $user.ObjectId
   ```

4. **Establish a review process:**
   - Review Tenant Creator role assignments quarterly
   - Document business justification for each assignment
   - Monitor tenant creation activities through audit logs
   - Implement approval workflow for new tenant creation requests

## Default Value

By default, the `Users can create tenants` setting is set to `Yes`, allowing all users to create new tenants. Organizations should change this to `No`.

## References

- [Restrict tenant creation in Azure Active Directory](https://docs.microsoft.com/en-us/azure/active-directory/roles/permissions-reference#tenant-creator)
- [Default user permissions in Azure AD](https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/users-default-permissions)
- [Azure AD built-in roles](https://docs.microsoft.com/en-us/azure/active-directory/roles/permissions-reference)

