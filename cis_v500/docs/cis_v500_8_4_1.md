## Description

The Azure Bastion service allows secure remote access to Azure Virtual Machines over the Internet without exposing remote access protocol ports and services directly to the Internet.

Azure Bastion provides:
- Secure RDP/SSH connectivity over TLS
- No public IP addresses needed on VMs
- Protection against port scanning and zero-day exploits
- Centralized access control and logging
- Integration with Azure AD for authentication

Using Azure Bastion eliminates the need to expose VMs directly to the internet via RDP (port 3389) or SSH (port 22), significantly reducing the attack surface.

## Remediation

### From Azure Portal

1. Go to `Bastions`.
2. Click `+ Create`.
3. Complete the creation wizard:
   - Select subscription and resource group
   - Provide a name for the Bastion host
   - Select the region (must match your VNet)
   - Select or create a virtual network
   - Create an `AzureBastionSubnet` subnet (minimum /26 CIDR)
   - Create or select a public IP address
   - Select SKU (Basic or Standard)
4. Click `Review + create`, then `Create`.

### From Azure CLI

First, create the AzureBastionSubnet:

```bash
az network vnet subnet create \
  --resource-group <resource-group> \
  --vnet-name <vnet-name> \
  --name AzureBastionSubnet \
  --address-prefixes <subnet-cidr>
```

Then create the Bastion host:

```bash
az network bastion create \
  --name <bastion-name> \
  --resource-group <resource-group> \
  --vnet-name <vnet-name> \
  --location <location> \
  --public-ip-address <public-ip-name>
```

### From PowerShell

```bash
$vnet = Get-AzVirtualNetwork -Name <vnetName> -ResourceGroupName <resourceGroupName>
Add-AzVirtualNetworkSubnetConfig -Name AzureBastionSubnet -VirtualNetwork $vnet -AddressPrefix <subnetCIDR>
$vnet | Set-AzVirtualNetwork

$publicIp = New-AzPublicIpAddress -ResourceGroupName <resourceGroupName> -Name <publicIpName> -Location <location> -AllocationMethod Static -Sku Standard

New-AzBastion -ResourceGroupName <resourceGroupName> -Name <bastionName> -PublicIpAddress $publicIp -VirtualNetwork $vnet
```

### Default Value

Azure Bastion is not deployed by default and must be explicitly created.

