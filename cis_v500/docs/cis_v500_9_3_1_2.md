## Description

For increased security, regenerate storage account access keys periodically to reduce the window of opportunity for compromised keys.

Access keys should be regenerated on a regular basis (recommended: every 90 days) to minimize the risk of unauthorized access. When regenerating keys, ensure that applications are updated to use the new key before regenerating the old key.

## Remediation

### From Azure Portal

1. Go to `Storage Accounts`.
2. For each storage account, under `Security + networking`, click `Access keys`.
3. Review the key creation date.
4. If keys have not been rotated recently, click `Rotate key` for key1 or key2.
5. Update applications to use the regenerated key.
6. After applications are updated, rotate the other key.

### From Azure CLI

```bash
az storage account keys renew --account-name <storage-account> --resource-group <resource-group> --key key1
```

Then, after updating applications:

```bash
az storage account keys renew --account-name <storage-account> --resource-group <resource-group> --key key2
```

### From PowerShell

```bash
New-AzStorageAccountKey -ResourceGroupName <resource-group> -Name <storage-account> -KeyName key1
```

Then, after updating applications:

```bash
New-AzStorageAccountKey -ResourceGroupName <resource-group> -Name <storage-account> -KeyName key2
```

### Default Value

Storage account keys are not automatically rotated.

