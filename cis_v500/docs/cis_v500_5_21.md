## Description

Restrict Microsoft 365 group creation to administrators only.

## Rationale

Microsoft 365 Groups (formerly Office 365 Groups) are used across multiple Microsoft services including:
- Microsoft Teams (each Team is backed by a Microsoft 365 Group)
- SharePoint Online (modern sites use Microsoft 365 Groups)
- Outlook (for group conversations and calendars)
- Planner (for task management)
- Yammer (for social networking)
- Stream (for video sharing)

When users can create Microsoft 365 Groups freely, it creates several concerns:

**Security and compliance risks:**
- Uncontrolled proliferation of groups and associated resources
- Groups may be created with inadequate security settings
- Potential for data sprawl and shadow IT
- Difficulty tracking and managing all groups
- Compliance challenges with data governance
- Groups may be created for inappropriate purposes

**Data governance challenges:**
- Each group creates multiple associated resources (mailbox, SharePoint site, etc.)
- Difficult to maintain data classification and protection
- Sensitivity labels may not be consistently applied
- Retention policies harder to enforce
- eDiscovery and legal hold complications
- Data residency and sovereignty concerns

**Resource management:**
- Excessive storage consumption
- License allocation challenges
- Difficult to identify and remove unused groups
- Naming convention violations
- Duplicate or redundant groups
- Cost management difficulties

**Information architecture:**
- Inconsistent group/team structure
- Poor naming conventions
- Lack of documentation
- Difficult to find relevant groups
- Reduced discoverability of resources
- Organizational chaos

By restricting Microsoft 365 Group creation to administrators:
- Centralized governance over collaboration spaces
- Consistent application of security and compliance policies
- Better control over resource consumption
- Enforcement of naming standards
- Clear ownership and lifecycle management
- Reduced shadow IT and ungoverned collaboration

This is a CIS Level 2 recommendation. Organizations must balance governance with user productivity, as Microsoft 365 Groups are fundamental to modern collaboration in Microsoft 365.

## Audit

**From Azure Portal:**

1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Groups`
3. Select `General` settings
4. Under `Microsoft 365 Groups`, check the setting for `Users can create Microsoft 365 groups in Azure portals, API or PowerShell`
5. Verify that it is set to `No`

Alternatively, check through specific group settings:
1. From Azure Home open the portal menu in the top left, and select `Microsoft Entra ID`
2. Select `Groups`
3. Select `General` settings
4. Check if a security group is specified that contains users allowed to create groups

**From PowerShell:**

```powershell
Connect-AzureAD

# Get group settings
$settings = Get-AzureADDirectorySetting | Where-Object {$_.DisplayName -eq "Group.Unified"}

if ($settings) {
    $enableGroupCreation = ($settings.Values | Where-Object {$_.Name -eq "EnableGroupCreation"}).Value
    $groupCreationAllowedGroupId = ($settings.Values | Where-Object {$_.Name -eq "GroupCreationAllowedGroupId"}).Value

    Write-Host "Group creation enabled: $enableGroupCreation"
    if ($groupCreationAllowedGroupId) {
        $allowedGroup = Get-AzureADGroup -ObjectId $groupCreationAllowedGroupId
        Write-Host "Groups can be created by members of: $($allowedGroup.DisplayName)"
    }
} else {
    Write-Host "No group settings configured - default behavior (all users can create groups)"
}
```

## Remediation

**Option 1: Disable for all users (most restrictive)**

**From PowerShell:**

```powershell
Connect-AzureAD

# Check if settings already exist
$settings = Get-AzureADDirectorySetting | Where-Object {$_.DisplayName -eq "Group.Unified"}

if (!$settings) {
    # Create new settings from template
    $template = Get-AzureADDirectorySettingTemplate | Where-Object {$_.DisplayName -eq "Group.Unified"}
    $settings = $template.CreateDirectorySetting()
}

# Disable group creation for all users
$settings["EnableGroupCreation"] = "False"
$settings["GroupCreationAllowedGroupId"] = ""

# Save settings
if ($settings.Id) {
    Set-AzureADDirectorySetting -Id $settings.Id -DirectorySetting $settings
} else {
    New-AzureADDirectorySetting -DirectorySetting $settings
}

Write-Host "Microsoft 365 Group creation disabled for all users"
```

**Option 2: Allow specific users/groups (delegated approach)**

1. **Create a security group for users who can create groups:**

```powershell
Connect-AzureAD

# Create group for authorized creators
$group = New-AzureADGroup -DisplayName "M365-Group-Creators" `
                          -MailEnabled $false `
                          -SecurityEnabled $true `
                          -MailNickName "M365GroupCreators" `
                          -Description "Members can create Microsoft 365 Groups"

# Add authorized users to the group
$user = Get-AzureADUser -Filter "userPrincipalName eq '<user@example.com>'"
Add-AzureADGroupMember -ObjectId $group.ObjectId -RefObjectId $user.ObjectId
```

2. **Configure group creation to be restricted to that group:**

```powershell
# Get or create settings
$settings = Get-AzureADDirectorySetting | Where-Object {$_.DisplayName -eq "Group.Unified"}

if (!$settings) {
    $template = Get-AzureADDirectorySettingTemplate | Where-Object {$_.DisplayName -eq "Group.Unified"}
    $settings = $template.CreateDirectorySetting()
}

# Configure settings
$settings["EnableGroupCreation"] = "True"
$settings["GroupCreationAllowedGroupId"] = $group.ObjectId

# Save settings
if ($settings.Id) {
    Set-AzureADDirectorySetting -Id $settings.Id -DirectorySetting $settings
} else {
    New-AzureADDirectorySetting -DirectorySetting $settings
}

Write-Host "Microsoft 365 Group creation restricted to members of: $($group.DisplayName)"
```

**From Azure Portal (setting up allowed group):**

After creating a security group with authorized creators, the restriction is enforced automatically. There's no direct UI to configure this - it must be done via PowerShell or Graph API.

**Best Practices:**

1. **Establish group request process:**
   - Create clear process for requesting new groups/teams
   - Define approval workflow and criteria
   - Require business justification
   - Document group purpose and ownership
   - Set naming convention requirements
   - Define security and compliance requirements

2. **Group creation governance:**
   - Enforce naming conventions
   - Apply sensitivity labels automatically
   - Set default expiration policies
   - Require group owners
   - Apply retention policies
   - Configure guest access settings

3. **Delegation considerations:**
   - Identify users who legitimately need to create groups
   - Consider per-department delegated creators
   - Provide training to delegated creators
   - Regular review of who has creation permissions
   - Monitor creation activities

4. **Alternative approaches:**
   - Use templates for common group types
   - Implement approval workflows through Power Automate
   - Use Azure AD access packages
   - Enable self-service through governed portals
   - Leverage SharePoint hub sites for structured collaboration

5. **User communication:**
   - Inform users about the change
   - Provide clear instructions for requesting groups/teams
   - Set expectations for approval timelines
   - Explain the benefits of governance
   - Offer training on proper group usage

6. **Monitoring and lifecycle:**
   - Regular audits of all Microsoft 365 Groups
   - Remove inactive or unused groups
   - Review group ownership
   - Monitor guest access
   - Track resource consumption
   - Implement expiration policies

7. **Balance with productivity:**
   - This restriction can impact user productivity
   - Consider organizational culture and needs
   - May want to enable with delegated creators
   - Ensure request process is efficient
   - Consider using Teams templates for common scenarios

## Default Value

By default, all users can create Microsoft 365 Groups. Organizations implementing governance should restrict this capability.

## References

- [Manage who can create Microsoft 365 Groups](https://docs.microsoft.com/en-us/microsoft-365/admin/create-groups/manage-creation-of-groups)
- [Plan for governance in Microsoft 365 Groups](https://docs.microsoft.com/en-us/microsoft-365/solutions/collaboration-governance-overview)
- [Microsoft 365 Groups naming policy](https://docs.microsoft.com/en-us/microsoft-365/admin/create-groups/groups-naming-policy)
- [Microsoft 365 Groups expiration policy](https://docs.microsoft.com/en-us/microsoft-365/admin/create-groups/office-365-groups-expiration-policy)

